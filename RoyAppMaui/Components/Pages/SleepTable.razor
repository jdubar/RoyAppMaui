@page "/"

@using RoyAppMaui.Models

<MudDataGrid T="Sleep"
             Items="@_items"
             Bordered="true"
             Elevation="25"
             ReadOnly="false">
    <Columns>
        <PropertyColumn Property="x => x.Id" />
        <PropertyColumn Property="x => x.BedtimeDisplay" Title="Bedtime" />
        <PropertyColumn Property="x => x.BedtimeRec" Title="(As Decimal)" IsEditable="false" />
        <PropertyColumn Property="x => x.WaketimeDisplay" Title="Waketime" />
        <PropertyColumn Property="x => x.WaketimeRec" Title="(As Decimal)" IsEditable="false" />
        <PropertyColumn Property="x => x.Duration" IsEditable="false" />
        <TemplateColumn CellClass="d-flex justify-end">
            <CellTemplate>
                <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.Edit" OnClick="@(()=>Edit(@context.Item))" />
            </CellTemplate>
        </TemplateColumn>
    </Columns>
</MudDataGrid>
<br />
<MudCard Elevation="25">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">Add / Edit Sleep</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>
        <MudNumericField @bind-Value="_sleep.Id"
                         Label="Id"
                         Variant="Variant.Text"
                         Margin="Margin.Normal" />
        <MudStack Row="true">
            <MudTimePicker @ref="_bedtimepicker"
                           AmPm="true"
                           Editable="true"
                           Elevation="12"
                           HelperText="Enter any numeric value as hours:minutes"
                           ImmediateText="true"
                           Label="Bedtime"
                           Margin="Margin.Normal"
                           PickerClosed="ResetBedTimeValidation"
                           PickerVariant="PickerVariant.Dialog"
                           Placeholder="hh:mm"
                           Time="_sleep.Bedtime"
                           TimeChanged="HandleBedTimeChange"
                           TimeFormat="HH:mm"
                           Variant="Variant.Text"/>
            <MudNumericField Value="_sleep.BedtimeRec"
                             Label="Decimal"
                             Variant="Variant.Text"
                             Margin="Margin.Normal" />
        </MudStack>
        <MudStack Row="true">
            <MudTimePicker @ref="_waketimepicker"
                           AmPm="true"
                           Editable="true"
                           Elevation="12"
                           HelperText="Enter any numeric value as hours:minutes"
                           ImmediateText="true"
                           Label="Waketime"
                           Margin="Margin.Normal"
                           PickerClosed="ResetWakeTimeValidation"
                           PickerVariant="PickerVariant.Dialog"
                           Placeholder="hh:mm"
                           Time="_sleep.Waketime"
                           TimeChanged="HandleWakeTimeChange"
                           TimeFormat="HH:mm"
                           Variant="Variant.Text" />
            <MudNumericField Value="_sleep.WaketimeRec"
                             Label="Decimal"
                             Variant="Variant.Text"
                             Margin="Margin.Normal" />
        </MudStack>
        <br />
        <MudButton Variant="Variant.Filled" Color="Color.Success" OnClick="Save">Save</MudButton>
    </MudCardContent>
</MudCard>
